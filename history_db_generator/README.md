
# Генератор базы данных исторических событий России

Данный компонент отвечает за автоматическое создание и пополнение базы данных исторических событий России с использованием Google Gemini API.

## Функциональность

1. **Генерация тем**: Скрипт получает максимально полный список исторических тем России
2. **Сбор событий**: По каждой теме собираются детальные исторические события
3. **Определение места**: Для каждого события определяется место и географические координаты
4. **Категоризация**: События распределяются по категориям

## Структура компонента

```
history_db_generator/
├── backups/            # Директория с резервными копиями
├── temp/               # Временные файлы
├── README.md           # Текущий файл документации
├── generator.py        # Основной модуль генерации
├── requirements.txt    # Зависимости
└── russian_history_database.json  # Сгенерированная база данных
```

## Использование

### Подготовка к запуску

1. Убедитесь, что у вас есть API-ключи для Google Gemini в файле `gemini_api_keys.py` в корневой директории проекта

2. Установите необходимые зависимости:
```bash
pip install -r history_db_generator/requirements.txt
```

### Запуск генерации

Для запуска процесса генерации используйте:

```bash
python run_gemini_generator.py
```

### Процесс работы

1. Скрипт сначала генерирует список исторических тем России
2. Затем для каждой темы собирает детальные исторические события
3. Определяет географическое местоположение каждого события
4. Классифицирует события по категориям
5. Сохраняет результаты в JSON-файл

## Параметры генерации

Основные параметры генерации можно настроить в файле `generator.py`:

| Параметр | Описание |
|----------|----------|
| `HISTORICAL_TOPICS_LIMIT` | Максимальное количество тем для сбора |
| `EVENTS_PER_TOPIC` | Количество событий, собираемых по каждой теме |
| `USE_CACHING` | Использовать ли кэширование для экономии запросов к API |
| `RETRY_ATTEMPTS` | Количество попыток при ошибках API |
| `BACKUP_INTERVAL` | Интервал создания резервных копий |

## Категории событий

База данных включает следующие категории исторических событий:

1. **Войны и сражения** - военные конфликты, битвы, сражения
2. **Культура и религия** - культурные и религиозные события, реформы
3. **Становление государства** - события формирования государственности
4. **Социальные реформы** - изменения в социальной структуре общества
5. **Революции и перевороты** - резкие изменения политического устройства
6. **Научные достижения** - открытия, изобретения, научный прогресс
7. **Дипломатия** - международные отношения, договоры, соглашения
8. **Экономика** - экономические реформы, кризисы, развитие
9. **Правление** - периоды правления монархов, политических лидеров
10. **Образование** - события в сфере образования
11. **Искусство** - значимые события в искусстве
12. **Технологии** - технологические достижения, индустриализация
13. **Личности** - события, связанные с выдающимися историческими личностями
14. **Географические открытия** - экспедиции, исследования, открытия

## Интеграция с основным проектом

Сгенерированная база данных используется основным ботом для предоставления информации о исторических событиях пользователям. База данных загружается и обрабатывается сервисами в директории `src/`.

## Проблемы и их решение

### Ограничения API

При превышении квоты API Gemini, скрипт автоматически переключится на следующий доступный API-ключ из списка в файле `gemini_api_keys.py`.

### Обработка ошибок

Скрипт включает механизмы обработки различных ошибок:
- Повторные попытки при временных ошибках API
- Кэширование промежуточных результатов
- Создание резервных копий

### Большие объемы данных

Для обработки больших объемов данных рекомендуется:
1. Увеличить интервал создания резервных копий
2. Уменьшить количество тем для генерации
3. Применить фильтрацию по историческим периодам
